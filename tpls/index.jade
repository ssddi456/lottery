doctype
html
  head
    meta(charset="utf8")
    link(rel="stylesheet", href="resources/twitter-bootstrap/3.2.0/css/bootstrap.min.css")
    link(rel="stylesheet", href="resources/app.css")
  body.bg
    .navbar.navbar-inverse.navbar-static-top
      ul.nav.navbar-nav.pull-right.middle-nav
        li
          .btn.btn-default(data-toggle="tooltip" 
            data-placement="bottom" 
            title="要导出数据，请点击旁边的扳手，点击“获得结果(cvs)”按钮")
            i.glyphicon.glyphicon-question-sign(href="#") 
              |  
        // ko if:(page() != 'setting')
        li
          .btn.btn-default(data-bind="click: page.bind(null,'setting')")
            i.glyphicon.glyphicon-wrench(href="#") 
              |  
        // /ko
        // ko if:(page() != 'lottory')
        li
          .btn.btn-default(data-bind="click: page.bind(null,'lottory')")
            i.glyphicon.glyphicon-ok(href="#")
              |  
        // /ko
    // ko if:(page() == 'lottory')
    .container(data-bind="click : toggleRunning")
      h1(data-bind="text : goods_description() + current_stage().status()")
      p(data-bind="text: '(已抽取' + picked_name() + '/' + total_name + ')'")
      .wrapper(data-bind="{\
                            attr : {\
                              class : wrapper_Class\
                            },\
                            visible : !edit_name_list()\
                          }")
        // ko foreach : current_res
        .name(data-bind="text : text")
        // /ko
    .navbar.navbar-inverse.navbar-fixed-bottom(data-bind="visible : !isRunning ()")
      .container.middle-nav
        button.btn.btn-default.left(data-bind="{\
                            click   : prev_stage,\
                            visible : has_prev_stage\
                          }")
          i.glyphicon.glyphicon-chevron-left
          | 前一个奖项
        button.btn.btn-default.pull-right(data-bind="{\
                            click   : next_stage,\
                            visible : has_next_stage\
                          }")
          i.glyphicon.glyphicon-chevron-right
          | 后一个奖项
        
    // /ko
    // ko if:(page() == 'setting')
    .container
      .row
        .col-sm-12
          button.btn.btn-default(data-bind="click : toggle(edit_name_list)")
            | 编辑人员名单
          button.btn.btn-default(data-bind="click : toggle(edit_goods)")
            | 编辑奖项
          button.btn.btn-default(data-bind="click  : exports_res")
            | 获得结果(json)
          button.btn.btn-default(data-bind="click  : exports_res.bind(null,'cvs')")
            | 获得结果(cvs)
          button.btn.btn-default(data-bind="click  : reset")
            | 重置设置
      // ko if:(edit_name_list())
      .edit_name_list
        textarea.input_names(placeholder="粘贴入人员名单",
                 style="width:1000px;",
                 data-bind="value : names")
      // /ko
      // ko if:(edit_goods())
      .row
        .col-sm-12
          table.table
            tbody(data-bind="foreach: goods")
              tr
                td
                  input(type="text",data-bind="value:name",placeholder="奖品名")
                td
                  input(type="text",data-bind="value:peer",placeholder="每次抽取")
                td
                  input(type="text",data-bind="value:total",placeholder="总数（为空则是无限制）")
                td
                  .btn.btn-default(data-bind="click: $parent.goods.remove.bind($parent.goods,$data)")
                    i.glyphicon.glyphicon-remove
          .btn.btn-default(data-bind="click:function(){ goods.push({ name : '', peer : 10, total : ''})}")
            | add goods
      // /ko
    // /ko
    script.
      var require = {
        paths: {
          _      : 'libs/underscore-min',
          jquery : 'libs/jquery-1.7.1.min',
          ko     : 'libs/knockout-3.1.0'
        },
        deps : ['app.js']
      };
    script(src="resources/jquery.js")
    script(src="resources/twitter-bootstrap/3.2.0/js/bootstrap.js")
    script(type="text/javascript", src="libs/require.js").
    script.
      document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>');

      +function(){
        $('[data-toggle="tooltip"]').tooltip();
      }()
